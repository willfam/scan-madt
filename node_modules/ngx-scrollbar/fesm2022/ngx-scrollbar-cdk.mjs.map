{"version":3,"file":"ngx-scrollbar-cdk.mjs","sources":["../../../projects/ngx-scrollbar/cdk/src/cdk-virtual-scroll.ts","../../../projects/ngx-scrollbar/cdk/src/ngx-scrollbar-cdk.ts"],"sourcesContent":["import {\r\n  Directive,\r\n  Input,\r\n  inject,\r\n  effect,\r\n  contentChild,\r\n  Signal,\r\n  EffectCleanupRegisterFn\r\n} from '@angular/core';\r\nimport { Platform } from '@angular/cdk/platform';\r\nimport { CdkVirtualScrollViewport } from '@angular/cdk/scrolling';\r\nimport { NgScrollbarExt } from 'ngx-scrollbar';\r\n\r\n@Directive({\r\n  standalone: true,\r\n  selector: 'ng-scrollbar[cdkVirtualScrollViewport]'\r\n})\r\nexport class NgScrollbarCdkVirtualScroll {\r\n\r\n  private readonly scrollbar: NgScrollbarExt = inject(NgScrollbarExt);\r\n\r\n  private readonly platform: Platform = inject(Platform);\r\n\r\n  private readonly virtualScrollViewportRef: Signal<CdkVirtualScrollViewport> = contentChild(CdkVirtualScrollViewport);\r\n\r\n  @Input() cdkVirtualScrollViewport: '' | 'auto';\r\n\r\n  constructor() {\r\n    this.scrollbar.externalViewport = '.cdk-virtual-scroll-viewport';\r\n    this.scrollbar.externalContentWrapper = '.cdk-virtual-scroll-content-wrapper';\r\n    this.scrollbar.externalSpacer = '.cdk-virtual-scroll-spacer';\r\n\r\n    effect((onCleanup: EffectCleanupRegisterFn) => {\r\n      // If content width is bigger than the viewport, we need to update the spacer width to display horizontal scrollbar\r\n      let resizeObserver: ResizeObserver;\r\n      const virtualScrollViewport: CdkVirtualScrollViewport = this.virtualScrollViewportRef();\r\n\r\n      const spacer: HTMLElement = virtualScrollViewport.elementRef.nativeElement.querySelector(this.scrollbar.externalSpacer);\r\n\r\n      if (this.platform.isBrowser && virtualScrollViewport) {\r\n        resizeObserver = new ResizeObserver((entries: ResizeObserverEntry[]) => {\r\n          entries.forEach((entry: ResizeObserverEntry) => {\r\n            if (virtualScrollViewport.orientation === 'vertical') {\r\n              spacer.style.setProperty('width', `${ entry.contentRect.width }px`);\r\n            } else {\r\n              spacer.style.setProperty('height', `${ entry.contentRect.height }px`);\r\n            }\r\n          });\r\n\r\n          // Disconnect after first change if directive is not set to auto\r\n          if (this.cdkVirtualScrollViewport !== 'auto') {\r\n            resizeObserver.disconnect();\r\n          }\r\n          // Observe content wrapper for size changes\r\n          resizeObserver.observe(virtualScrollViewport._contentWrapper.nativeElement);\r\n        });\r\n      }\r\n\r\n      onCleanup(() => resizeObserver?.disconnect());\r\n    });\r\n  }\r\n}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":";;;;;;MAiBa,2BAA2B,CAAA;AAUtC,IAAA,WAAA,GAAA;AARiB,QAAA,IAAA,CAAA,SAAS,GAAmB,MAAM,CAAC,cAAc,CAAC,CAAC;AAEnD,QAAA,IAAA,CAAA,QAAQ,GAAa,MAAM,CAAC,QAAQ,CAAC,CAAC;AAEtC,QAAA,IAAA,CAAA,wBAAwB,GAAqC,YAAY,CAAC,wBAAwB,CAAC,CAAC;AAKnH,QAAA,IAAI,CAAC,SAAS,CAAC,gBAAgB,GAAG,8BAA8B,CAAC;AACjE,QAAA,IAAI,CAAC,SAAS,CAAC,sBAAsB,GAAG,qCAAqC,CAAC;AAC9E,QAAA,IAAI,CAAC,SAAS,CAAC,cAAc,GAAG,4BAA4B,CAAC;AAE7D,QAAA,MAAM,CAAC,CAAC,SAAkC,KAAI;;AAE5C,YAAA,IAAI,cAA8B,CAAC;AACnC,YAAA,MAAM,qBAAqB,GAA6B,IAAI,CAAC,wBAAwB,EAAE,CAAC;AAExF,YAAA,MAAM,MAAM,GAAgB,qBAAqB,CAAC,UAAU,CAAC,aAAa,CAAC,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;YAExH,IAAI,IAAI,CAAC,QAAQ,CAAC,SAAS,IAAI,qBAAqB,EAAE;AACpD,gBAAA,cAAc,GAAG,IAAI,cAAc,CAAC,CAAC,OAA8B,KAAI;AACrE,oBAAA,OAAO,CAAC,OAAO,CAAC,CAAC,KAA0B,KAAI;AAC7C,wBAAA,IAAI,qBAAqB,CAAC,WAAW,KAAK,UAAU,EAAE;AACpD,4BAAA,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC,OAAO,EAAE,CAAI,EAAA,KAAK,CAAC,WAAW,CAAC,KAAM,CAAA,EAAA,CAAI,CAAC,CAAC;yBACrE;6BAAM;AACL,4BAAA,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAI,EAAA,KAAK,CAAC,WAAW,CAAC,MAAO,CAAA,EAAA,CAAI,CAAC,CAAC;yBACvE;AACH,qBAAC,CAAC,CAAC;;AAGH,oBAAA,IAAI,IAAI,CAAC,wBAAwB,KAAK,MAAM,EAAE;wBAC5C,cAAc,CAAC,UAAU,EAAE,CAAC;qBAC7B;;oBAED,cAAc,CAAC,OAAO,CAAC,qBAAqB,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;AAC9E,iBAAC,CAAC,CAAC;aACJ;YAED,SAAS,CAAC,MAAM,cAAc,EAAE,UAAU,EAAE,CAAC,CAAC;AAChD,SAAC,CAAC,CAAC;KACJ;8GA3CU,2BAA2B,EAAA,IAAA,EAAA,EAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,SAAA,EAAA,CAAA,CAAA,EAAA;AAA3B,IAAA,SAAA,IAAA,CAAA,IAAA,GAAA,EAAA,CAAA,oBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,IAAA,EAAA,2BAA2B,0NAMqD,wBAAwB,EAAA,WAAA,EAAA,IAAA,EAAA,QAAA,EAAA,IAAA,EAAA,CAAA,EAAA,QAAA,EAAA,EAAA,EAAA,CAAA,CAAA,EAAA;;2FANxG,2BAA2B,EAAA,UAAA,EAAA,CAAA;kBAJvC,SAAS;AAAC,YAAA,IAAA,EAAA,CAAA;AACT,oBAAA,UAAU,EAAE,IAAI;AAChB,oBAAA,QAAQ,EAAE,wCAAwC;AACnD,iBAAA,CAAA;wDASU,wBAAwB,EAAA,CAAA;sBAAhC,KAAK;;;ACzBR;;AAEG;;;;"}